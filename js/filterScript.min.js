window.onload = function () { const e = [{ key: "Who has died?", selector: ".who-has-died select" }, { key: "Circumstances of death", selector: ".circumstances-death select" }, { key: "Age of person needing support", selector: ".age-person-needing-support select" }, { key: "Type of support", selector: ".type-support select" }, { key: "Location", selector: ".location select" }]; let t = []; const n = document.querySelector(".total-results span"); function o() { try { const o = {}; e.forEach((({ key: e, selector: t }) => { const n = document.querySelector(t).value; "--" !== n && (o[e] = n) })); const r = t.filter((e => Object.entries(o).every((([t, n]) => e[t] && e[t].includes(n))))); c(r), n.innerHTML = Object.keys(r).length } catch (e) { r("Error filtering results, please try again.") } } function c(e) { try { const t = document.querySelector(".listContent"); if (!t) throw new Error("List content element not found"); if (t.innerHTML = "", 0 === e.length) { const e = document.createElement("article"); e.className = "title-post", e.textContent = "No results found", t.appendChild(e) } else e.forEach((e => { const n = document.createElement("article"); n.className = "title-post"; const o = document.createElement("div"); o.className = "title-post-wrapper"; const c = document.createElement("h2"); if (c.textContent = e.Title, o.appendChild(c), e.hasOwnProperty("Content")) { const t = document.createElement("div"); t.className = "title-content"; const n = function (e) { const t = document.createElement("template"); return t.innerHTML = e, t.content.cloneNode(!0) }(e.Content); t.appendChild(n), o.appendChild(t) } n.appendChild(o), t.appendChild(n) })) } catch (e) { r("Error displaying results, please check the content.") } } function r(e) { const t = document.querySelector(".listContent"); if (t) { t.innerHTML = ""; const n = document.createElement("article"); n.className = "title-post error", n.textContent = e, t.appendChild(n) } } e.forEach((({ selector: e }) => { const t = document.querySelector(e); t && t.addEventListener("change", o) })), document.getElementById("clear-filters").addEventListener("click", (function () { try { e.forEach((({ selector: e }) => { const t = document.querySelector(e); t && (t.value = "--") })), c(t) } catch (e) { r("Error clearing filters, please try again.") } })), async function () { try { const o = await fetch("./services_converted.json"); if (!o.ok) throw new Error(`HTTP error! Status: ${o.status}`); const s = await o.json(); t = s, e.forEach((({ key: e, selector: t }) => { const n = document.querySelector(t); if (n) { !function (e, t) { try { if (!e) throw new Error("Dropdown element not found"); t.forEach((t => { const n = document.createElement("option"); n.value = t, n.textContent = t, e.appendChild(n) })) } catch (e) { r("Error populating dropdown, please check the data.") } }(n, [...new Set(s.flatMap((t => t[e] || [])).sort())]) } })), c(t), n.innerHTML = Object.keys(t).length } catch (e) { r("Error loading data, please try again later.") } }() };